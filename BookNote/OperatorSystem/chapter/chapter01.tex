\chapter{计算机系统概述}

\section{操作系统的基本概念}

\subsection{操作系统的概念}

    \emph{操作系统(Operator System)是指控制和管理整个计算机系统的{\color{red}硬件和软件资源}，合理地组织、调度计算机的工作与资源的分配，进而为用户和其他软件提供方便接口与环境的程序集合。}

    \emph{\color{red}操作系统是计算机系统中最基本的系统软件。}

\subsection{操作系统的特征}

    操作系统有如下四大特征：

\begin{itemize}
    \item [1.] 并发(Concurrence)
    \subitem 并发是指两个或多个事件在同一时间间隔内发生。值得注意的是：\emph{并发和并行是两个不同的概念，{\color{red}并行一定并发，并发不一定并行。对于单处理器来说，只能并发执行。}}
    \subitem \emph{并发是OS最为基础且必要的特征。}
    \item [2.] 共享(Sharing)
    \subitem 共享即资源共享，是建立在并发之上的。
    \subitem (互斥式共享) 系统中的某些资源在一个时间段内有且仅能一个程序进行访问和操作，且把\emph{{\color{red}该资源称为临界资源。}}
    \subitem (同时式共享) 该类资源可以由多个程序同时段进行访问(多出现在读操作上)
    \subitem \emph{并发和共享是操作系统{\color{red}最基本}的特征，两者之间互为存在的条件：资源共享必定是由并发产生的，而共享影响了并发则会导致并发崩溃。}
    \item [3.] 虚拟(Virtual)
    \subitem \emph{虚拟是指把一个物理上的实体变为若干逻辑上的对应物。{\color{red}物理实体是实际存在的，而虚拟逻辑是用户感觉上的事物。}}
    \subitem 虚拟处理器的存在：时分复用技术
    \subitem 虚拟内存的存在：空分复用技术
    \item [4.] 异步(Asynchronism)
    \subitem 多道程序环境允许多个程序执行，但由于资源有限(竞争的情况)，进程并非一贯到底的执行。而且走走停停，不停的切换，因此以不可预知的速度向前推进。
\end{itemize}

\subsection{操作系统的目标与功能}

    \emph{为了给多道程序提供环境，OS应该具备：处理机(进程)管理、存储器(内存)管理、设备管理和文件管理(现代操作系统中，不仅仅这几个模块)。}

    \emph{除了上述的模块外，还需要提供各种接口。}

\subsubsection{操作系统作为计算机系统资源的管理者}

\begin{itemize}
    \item [1)] 处理机(进程)管理
    \subitem 在多道程序环境下，处理机的分配和运行都以进程(或线程)为基本单位，因此对处理机管理可归结为进程管理。
    \subitem 并发指的是\emph{计算机内同时运行多个进程，因此如何管理进程则是最主要的任务。进程管理的主要功能包括进程控制、进程同步、进程通信、死锁处理、处理机调度等。}
    \item [2)] 存储器(内存)管理
    \subitem 内存管理是为了给多道程序的运行提供良好的环境，方便用户使用以及提高利用率。\emph{其主要包括内存分配与回收、地址映射、内存保护与共享和内存扩充等。}
    \item [3)] 文件管理
    \subitem \emph{{\color{red}计算机中的信息都是以文件的形式存在的}，文件管理包括文件存储空间的管理、目录管理以及文件读写管理与保护等。}
    \item [4)] 设备管理
    \subitem 设备管理的主要任务是完成用户的I/O请求，方便用户使用各种设备，提高设备利用率。主要包括缓冲管理、设备分配、设备处理和虚拟设备等。
\end{itemize}

\subsubsection{操作系统作为用户与计算机硬件系统之间的接口}

\begin{itemize}
    \item [1)] 命令接口
    \subitem (联机命令接口(交互式)) \emph{{\color{red}适用于分时或实时操作系统。}由一组键盘命令组成，用户通过控制台或terminal输入命令与OS进行交互。}类似于Python交互器。
    \subitem (脱机命令接口(批处理)) \emph{{\color{red}适用于批处理系统。}由一组作业控制命令组成，不能直接干预作业的运行，事先使用对应的作业控制命令写成一份操作流程，然后递交给OS。}类似于Bash脚本。
    \item [2)] 程序接口
    \subitem 程序接口由系统调用(又称广义指令)组成，例如printf、malloc等C语言调用接口。
    \subitem GUI就是图形接口，其最终是通过调用程序接口实现的。{\color{red}严格的说，GUI不是操作系统的一部分，但GUI所使用的系统调用是OS的一部分。}
\end{itemize}

\subsubsection{操作系统实现了对计算机资源的扩展}

    \emph{没有{\color{red}任何软件支持的}计算机被称为裸机，其仅构成计算机系统的物质基础。}

    也就是说，操作系统的内部是各种物理结构所组成的逻辑环境，操作系统所提供的资源管理功能和方便用户的各种服务功能，将裸机改造成功能更强、更方便的机器。\emph{通常，把覆盖了软件的机器称为扩充机器或虚拟机。}

\section{操作系统发展历程}

\subsection{手工操作系统}

    \emph{此阶段并未产生严格意义上的OS。} 

    手工操作系统的突出缺点：\emph{用户独占全机，资源利用效率极低；CPU等待手工操作，CPU利用效率极低。}

\subsection{批处理阶段}

    \emph{为了解决人机矛盾以及I/O设备之间速度不匹配的问题，出现了批处理系统。}

\subsubsection{单道批处理系统}

    系统对作业的处理是成批进行的，但{\color{red}内存中始终只保存一道作业。}其主要特征为：

\begin{itemize}
    \item [1)] 自动性。磁带上的一批作业自动逐个进行，无需人工干预
    \item [2)] 顺序性。磁带上的作业按顺序进入内存
    \item [3)] 单道性。内存中仅有一道作业运行，即监督程序每次从磁带上只调入一道程序。
\end{itemize}

    单道批处理系统的主要问题在于：\emph{内存中仅有一道作业，CPU有大量的时间是在等待I/O的完成。}

\subsubsection{多道批处理系统}

    为了解决资源利用率和系统吞吐量，引入了多道程序技术。\emph{多道程序技术允许多个程序同时进入内存并允许在CPU中交替运行，共享系统中的各种软硬件资源。}

    其设计的特点为\emph{多道、{\color{red}宏观上并行，微观上串行。}}但是，多道程序设计需要解决：

\begin{itemize}
    \item [1)] 如何分配处理器
    \item [2)] 如何分配内存
    \item [3)] 如何分配I/O设备
    \item [4)] 如何组织和存放大量的程序和数据，且保证数据安全和一致性
\end{itemize}

    其优点在于：\emph{资源利用率高，且共享计算机资源从而使各种资源得到充分利用；系统吞吐量大，CPU和其他资源保持“忙碌”状态。}

    缺点在于：\emph{用户响应时间较长；不提供人机交互能力，用户既不能了解运行情况也不能控制计算机。}

\subsubsection{分时操作系统}

    \emph{分时技术，也就是将处理器的运行时间分成很短的时间片，按照时间片轮流把处理器分配给各联机作业使用。{\color{red}这使得每个用户(程序)感觉起来就像自己独占一台计算机}。}

    \emph{分时操作系统，指的是多个用户通过终端同时共享一台主机，用户可以同时与主机进行交互操作而互不干扰。}因此，分时系统最关键的问题在于：{\color{red}如何使用户与自己的作业交互}。分时系统支持多道程序设计，但不同于多道批处理，分时系统是人机交互的系统：

\begin{itemize}
    \item [1)] 同时性。\emph{同时性又称多路性，允许多个终端用户同时使用一台计算机。}
    \item [2)] 交互性。用户能够与系统进行人机对话。
    \item [3)] 独立性。系统中的各个用户独立操作，互不干扰。
    \item [4)] 及时性。用户请求能在很短时间内响应，采用时间片轮转算法。
\end{itemize}

\subsubsection{实时操作系统}

    \emph{为了满足某个时间限制内完成某些紧急任务而不需要时间片排队，诞生了实时操作系统。}

    硬实时系统：\emph{某个动作必须绝对地在规定的时刻内完成或发生。}

    软实时系统：\emph{能够接收偶尔违反时间规定且不会引起任何永久性的损害。}

    在实时操作系统的控制下，计算机系统接收到外部信号后及时处理，并在严格时间内处理完毕，其主要特点就是{\color{red}及时性和可靠性}。
